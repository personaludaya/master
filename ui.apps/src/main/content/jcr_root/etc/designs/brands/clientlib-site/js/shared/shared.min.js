"use strict";var $=require("jquery"),_=require("underscore"),comparisonTempalate=require("product-comparison-item-partial"),amplify=require("amplify"),Utils=function(){function e(){this.productOverviewClassName=".product-info-overview",this.articleClassName=".article",this.compareProductClassName=".compare-products-slide",this.maxAllowedComparison=4,this.productInfoOverviewSelector=".product-info-overview",this.productUniqueIdAttribute="data-product-unique-id",this.categoryUniqueIdAttribute="data-category-unique-id",this.ecproductUniqueIdAttribute="data-ecproduct-unique-id",this.eccategoryUniqueIdAttribute="data-eccategory-unique-id",this.categoryTitleAttribute="data-category-title",this.selectedCompareItems=[],this.comparisonBarContainerSelector=".product-comparison-bar-container",this.comparisonSelectIndicatorTemplate=_.template("<%= count %> out of <%= total %>"),this.selectedProductComparisonKey="selected-product-comparison",this.headerSelector=".header",this.footerSelector=".footer-container",this.chatbotWrapper=".chatbot-wrapper",this.chatbotTransitionDuration=1e3,this.chatbotTextList=[".."]}return e.prototype.typedAnimate=function(){$(this.chatbotWrapper+":visible").find("h4.message.conversation-loader span").typed({strings:this.chatbotTextList,loop:!0,typeSpeed:500,showCursor:!1})},e.prototype.chatbotUserInteraction=function(){var e=this;$(this.chatbotWrapper).show(),$(this.chatbotWrapper+":visible").find(".from-user").length<1&&$(this.chatbotWrapper+":visible").find(".from-chatbot").finish().css({opacity:0,position:"absolute",top:"70%"}),$(window).width()<=window.brands.mobile_screen?$(this.chatbotWrapper+":visible").find("h1.message").parent().finish().animate({top:1,opacity:1},this.chatbotTransitionDuration,"swing",function(){$(e.chatbotWrapper+":visible").find("h4.message:eq(0)").parent().finish().animate({top:6+$(e.chatbotWrapper+":visible").find("h1.message").parent().height(),opacity:1},e.chatbotTransitionDuration,"swing",function(){$(e.chatbotWrapper+":visible").find("h4.message:eq(1)").parent().finish().animate({top:11+$(e.chatbotWrapper+":visible").find("h1.message").parent().height()+$(e.chatbotWrapper+":visible").find("h4.message:eq(0)").parent().height(),opacity:1},e.chatbotTransitionDuration,"swing",function(){$(e.chatbotWrapper+":visible").find("h4.message:eq(2)").parent().finish().animate({top:16+$(e.chatbotWrapper+":visible").find("h1.message").parent().height()+$(e.chatbotWrapper+":visible").find("h4.message:eq(0)").parent().height()+$(e.chatbotWrapper+":visible").find("h4.message:eq(1)").parent().height(),opacity:1},e.chatbotTransitionDuration,"swing",function(){$(e.chatbotWrapper+":visible").css({"overflow-y":"auto"})})})})}):$(this.chatbotWrapper+":visible").find("h1.message").parent().finish().animate({top:0,opacity:1},this.chatbotTransitionDuration,"swing",function(){$(e.chatbotWrapper+":visible").find("h4.message:eq(0)").parent().finish().animate({top:5+$(e.chatbotWrapper+":visible").find("h1.message").parent().height(),opacity:1},e.chatbotTransitionDuration,"swing",function(){$(e.chatbotWrapper+":visible").find("h4.message:eq(1)").parent().finish().animate({top:10+$(e.chatbotWrapper+":visible").find("h1.message").parent().height()+$(e.chatbotWrapper+":visible").find("h4.message:eq(0)").parent().height(),opacity:1},e.chatbotTransitionDuration,"swing",function(){$(e.chatbotWrapper+":visible").find("h4.message:eq(2)").parent().finish().animate({top:15+$(e.chatbotWrapper+":visible").find("h1.message").parent().height()+$(e.chatbotWrapper+":visible").find("h4.message:eq(0)").parent().height()+$(e.chatbotWrapper+":visible").find("h4.message:eq(1)").parent().height(),opacity:1},e.chatbotTransitionDuration,"swing",function(){$(e.chatbotWrapper+":visible").css({"overflow-y":"auto"})})})})})},e.prototype.rebindHeaderAndFooterLinksWithoutHash=function(){$(this.headerSelector+", "+this.footerSelector).find("a[href]").each(function(e,t){var i=$(t).attr("href");if(i.indexOf("#")>-1){var n=i.substr(i.indexOf("#"));n=n.split(",")[0],i=i.substr(0,i.indexOf("#"))+n,$(t).attr("href",i)}})},e.prototype.productOverviewButtonAlignmentEqualizer=function(e){if(void 0===e&&(e=!1),$(this.productOverviewClassName).parent().parent().find(".col-xs-12").length<1)return void("function"==typeof e&&e());if($(window).width()<=window.brands.mobile_screen)return $(this.productOverviewClassName).parent().parent().each(function(e,t){$(t).find(".col-xs-12").css("height","auto")}),void("function"==typeof e&&e());var t=function(e,t){$(e).find(".col-xs-12").css("height","auto");var i=($(e).find(".col-xs-12").width(),Math.max.apply(null,$(e).find(".col-xs-12").map(function(e,t){return $(t).height()}).get()));Math.max.apply(null,$(e).find(".col-xs-12 h5").map(function(e,t){return $(t).height()}).get()),Math.max.apply(null,$(e).find(".col-xs-12").find(".product-info-overview-detail").map(function(e,t){return $(t).height()}).get());t?$(e).find(".col-xs-12").css("height",i):$(e).find(".col-xs-12").css("height",i)};$(this.productOverviewClassName).parent().parent().each(function(e,i){t(i,!1),$(i).find("img:last").on("load",function(){t(i,!0)}),$(i).find("img:last").on("error",function(){t(i,!0)})}),"function"==typeof e&&e()},e.prototype.articleListingAlignmentEqualizer=function(){if(!($(this.articleClassName).parent().parent().find(".col-xs-12").length<1))return $(window).width()<=window.brands.mobile_screen?void $(this.articleClassName).parent().parent().each(function(e,t){$(t).find(".col-xs-12").css("height","auto")}):void $(this.articleClassName).parent().parent().each(function(e,t){var i=($(t).find(".col-xs-12").width(),Math.max.apply(null,$(t).find(".col-xs-12").map(function(e,t){return $(t).height()}).get()));$(t).find(".col-xs-12").css("height",i)})},e.prototype.compareProductAlignmentEqualizer=function(){if(!($(this.compareProductClassName).length<1)){var e=[];$(this.compareProductClassName).each(function(t,i){$(i).find(".info-content-row").each(function(t,i){var n=$(i).find(".col-lg-12").height();e.length>t&&n>e[t]?e[t]=n:e.length<=t&&e.push(n)})}),e.length>0&&$(this.compareProductClassName).each(function(t,i){$(i).find(".info-content-row").each(function(t,i){$(i).find(".col-lg-12").css({"min-height":e[t]})})});var t=Math.max.apply(null,$(this.compareProductClassName).find(".compare-products-info .content h4").map(function(e,t){return $(t).height()}).get());$(this.compareProductClassName).find(".compare-products-info .content h4").height(t)}},e.prototype.disabledCheckedBox=function(){this.selectedCompareItems.length==this.maxAllowedComparison?$(":checkbox:not(:checked)").prop("disabled",!0):$(":checkbox").prop("disabled",!1)},e.prototype.showHideComparisonBarContainer=function(){this.selectedCompareItems.length>0?($(".select-indicator").html(this.comparisonSelectIndicatorTemplate({count:this.selectedCompareItems.length,total:this.maxAllowedComparison})),$(this.comparisonBarContainerSelector).removeClass("hide")):$(this.comparisonBarContainerSelector).addClass("hide")},e.prototype.removeSelectedComparisonItem=function(e,t){if(void 0===t&&(t=!1),this.selectedCompareItems=_.filter(this.selectedCompareItems,function(t){return t.id!=e}),amplify.store(this.selectedProductComparisonKey,this.selectedCompareItems),t)t.remove(),$('input[data-product-unique-id="'+e+'"]').attr("checked",!1),this.disabledCheckedBox();else{var i=$(this.comparisonBarContainerSelector).find(".col-lg-8").find(".row").find('.brands-icon[data-selected-id="'+e+'"]');i.length>0&&(i.parent().parent().remove(),$('input[data-product-unique-id="'+e+'"]').attr("checked",!1),this.disabledCheckedBox())}this.showHideComparisonBarContainer()},e.prototype.renderComparisonbar=function(){var e=this;if((!this.selectedCompareItems||this.selectedCompareItems.length<1)&&(this.selectedCompareItems=amplify.store(this.selectedProductComparisonKey)||[]),this.selectedCompareItems.length>0){var t=$(this.comparisonBarContainerSelector).find(".col-lg-8").find(".row").children().length;t+=1;for(var i=function(t){var i=n.selectedCompareItems[t-1];i.icon=window.brands.icons.close;var o=$(comparisonTempalate.template(i)).appendTo($(n.comparisonBarContainerSelector).find(".col-lg-8").find(".row"));$(o).find(".brands-icon").on("click",function(t){e.removeSelectedComparisonItem($(t.currentTarget).attr("data-selected-id"),o)}),$('input[data-product-unique-id="'+i.id+'"]').attr("checked","checked")},n=this,o=t;o<=this.selectedCompareItems.length;o++)i(o);this.disabledCheckedBox()}else $(this.comparisonBarContainerSelector).find(".col-lg-8").find(".row").find(".brands-icon").each(function(t,i){e.removeSelectedComparisonItem($(i).attr("data-selected-id"),!1)})},e.prototype.bindProductComparison=function(){var e=this;$(".product-comparison-bar-container").attr("data-max-col")&&(this.maxAllowedComparison=$(".product-comparison-bar-container").attr("data-max-col")),$("#comparenow").off().on("click",function(t){t.preventDefault();var i=$(t.currentTarget).attr("data-href");if(i){var n={event:{eventInfo:{eventType:"product_comparison",eventName:_.pluck(e.selectedCompareItems,"id").join("|")}},product:{category:{primaryCategory:_.pluck(e.selectedCompareItems,"categoryid").join("|"),primaryCategoryID:_.pluck(e.selectedCompareItems,"eccategoryid").join("|")},productInfo:{productName:_.pluck(e.selectedCompareItems,"id").join("|"),productID:_.pluck(e.selectedCompareItems,"ecid").join("|")}}},o=_.pluck(e.selectedCompareItems,"id");i+="?maxCol="+e.maxAllowedComparison,i+="&q="+o.join(","),window.brands.tracker&&window.brands.tracker.buildAnalyticsWithLocalStorage(i,n)}}),$("#clearallselection").off().on("click",function(t){e.selectedCompareItems=[],amplify.store(e.selectedProductComparisonKey,null),e.renderComparisonbar(),e.showHideComparisonBarContainer()}),this.renderComparisonbar(),this.showHideComparisonBarContainer(),$(this.productInfoOverviewSelector).each(function(t,i){$(i).find(".checkbox").find("input["+e.productUniqueIdAttribute+"]").off().on("click",function(t){t.stopPropagation();var i=$(t.currentTarget).attr(e.categoryUniqueIdAttribute),n=$(t.currentTarget).attr(e.categoryTitleAttribute),o=$(t.currentTarget).attr(e.productUniqueIdAttribute),r=$(t.currentTarget).parent().next().find("h5").text(),a=$(t.currentTarget).parent().prev().find("img").attr("src"),s=$(t.currentTarget).attr(e.eccategoryUniqueIdAttribute),c=$(t.currentTarget).attr(e.ecproductUniqueIdAttribute),d=_.findIndex(e.selectedCompareItems,function(e){return e.id==o});d==-1?e.selectedCompareItems.length<e.maxAllowedComparison&&(e.selectedCompareItems.push({categoryid:i,eccategoryid:s,categorytitle:n,id:o,ecid:c,title:r,img:a}),amplify.store(e.selectedProductComparisonKey,e.selectedCompareItems),e.renderComparisonbar(),e.showHideComparisonBarContainer(),window.brands.tracker&&$(t.currentTarget).attr(window.brands.tracker.dataAnalyticsAttr)&&window.brands.tracker.customTrack($(t.currentTarget).attr(window.brands.tracker.dataAnalyticsAttr))):e.removeSelectedComparisonItem(o)}),$(i).find(".checkbox").off().on("click",function(t){var i=$(t.currentTarget).find("input["+e.productUniqueIdAttribute+"]");i.length<1||$(i).trigger("click")})})},e}();exports.Utils=Utils;var Loader=function(){function e(){this.loaderIndicatorTemplate=_.template('<svg class="brands-icon brands-loader icon-center fa-pulse"><use href="<%= icon %>" xlink:href="<%= icon %>"></use></svg>')}return e.prototype.show=function(e,t){void 0===t&&(t=!1),$(e).length<1||(t?$(e).html($(this.loaderIndicatorTemplate({icon:window.brands.icons.loader})).addClass("pull-center")):$(e).html(this.loaderIndicatorTemplate({icon:window.brands.icons.loader})))},e.prototype.hide=function(e){$(e).length<1||$(e).find(".brands-loader").remove()},e}();exports.Loader=Loader;var AccordionComponent=function(){function e(e,t){var i=this;this.accordionCollapsable=".collapsable",this.accordionContent=".content",this.accordionOpenDefault=".is-open",this.trackedFAQQuestions=[],this.accordionComponent="#"+e,$(this.accordionComponent).find(this.accordionCollapsable).each(function(e,n){$(n).parent().parent().find(i.accordionContent).slideUp(),$(n).parent().parent().first().find(i.accordionContent+i.accordionOpenDefault).length>0&&($(n).parent().parent().find(i.accordionContent+i.accordionOpenDefault).first().slideDown(),$(n).parent().find(".icon-expand").first().addClass("hide"),$(n).parent().find(".icon-collapse").first().removeClass("hide"));var o=function(){if($(n).parent().find(i.accordionContent).is(":visible"))t||$(n).parent().parent().find(i.accordionContent).first().slideUp(),$(n).parent().find(i.accordionContent).first().slideUp(),$(n).parent().find(".icon-expand").first().removeClass("hide"),$(n).parent().find(".icon-collapse").first().addClass("hide");else if(t||$(n).parent().parent().find(i.accordionContent).first().slideUp(),$(n).parent().find(i.accordionContent).first().slideDown(),$(n).parent().find(".icon-expand").first().addClass("hide"),$(n).parent().find(".icon-collapse").first().removeClass("hide"),$(i.accordionComponent).find(".product-faq").length>0&&window.brands.tracker){var e=$(n).parent().parent().find("li:first").text(),o=$(n).text();if($(i.accordionComponent).hasClass("product-accordion")||(e=$("#faqaccordion").parent().find("h2:first").text(),o=$(n).text()),i.trackedFAQQuestions.indexOf(o)>-1)return;i.trackedFAQQuestions.push(o),window.brands.tracker.trackFAQCategory(e.trim().replace(/(\r\n|\n|\r)/gm,""),o.trim().replace(/(\r\n|\n|\r)/gm,""))}};$(n).off().on("click",function(e){$(n).parent().parent().hasClass("product-accordion")&&$(window).width()>window.brands.mobile_screen||o()}),$(n).parent().find(".icon-expand, .icon-collapse").off().on("click",function(e){$(n).parent().parent().hasClass("product-accordion")&&$(window).width()>window.brands.mobile_screen||o()}),$("#seemorefaq").length>0&&$(i.accordionComponent).find(".product-faq").length>0&&($(i.accordionComponent).find(".accordion-wrapper").each(function(e,t){e>3&&$(t).hide()}),$("#seemorefaq").on("click",function(e){$(i.accordionComponent).find(".accordion-wrapper:hidden").each(function(e,t){e<3&&$(t).fadeIn()}),$(i.accordionComponent).find(".accordion-wrapper:hidden").length<1&&$("#seemorefaq").hide()}))})}return e}();exports.AccordionComponent=AccordionComponent;var ApiAICustom=function(){function e(){this.accessToken="9df32f4839ff408089222f118d8f266b",this.endpoint="https://api.api.ai/v1/",this.version="20150910",this.sessionId=this.generateSession(32)}return e.prototype.generateSession=function(e){for(var t="",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=0;n<e;n++)t+=i.charAt(Math.floor(Math.random()*i.length));return t},e.prototype.sendQuery=function(e){var t=this;$.ajax({type:"POST",url:this.endpoint+"query?v="+this.version,contentType:"application/json; charset=utf-8",dataType:"json",headers:{Authorization:"Bearer "+this.accessToken},data:JSON.stringify({q:e,lang:"en",sessionId:this.sessionId}),success:function(e){t.onResults&&"function"==typeof t.onResults&&t.onResults(e)},error:function(e,i,n){t.onError&&"function"==typeof t.onError&&t.onError(99,n)}})},e}();exports.ApiAICustom=ApiAICustom;