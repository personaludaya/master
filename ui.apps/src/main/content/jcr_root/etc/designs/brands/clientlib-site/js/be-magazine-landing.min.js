"use strict";var $=require("jquery"),shared_1=require("./shared"),Swiper=require("swiper"),BeMagazineLanding=function(){function e(){this.bemagazinecategorySlider=".js-be-magazine-category",this.articleSlider=".js-article-slider",this.bemagazineContent=".be-magazine-category-content",this.bemagazineContentWrapper=".be-magazine-category-content-wrapper",this.loadOnce=!0,this.loader=new shared_1.Loader,this.bemagazineDefaultSlideIndex=1,this.init()}return e.prototype.init=function(){var e=this,n=this;$(document).ready(function(){$(e.bemagazinecategorySlider).each(function(i,a){var t=new Swiper($(a),{loop:!1,slidesPerView:2,paginationClickable:!0,centeredSlides:!0,spaceBetween:0,breakpoints:{1199:{slidesPerView:1}},nextButton:$(a).parent().find(".swiper-bemagazine-category-next"),prevButton:$(a).parent().find(".swiper-bemagazine-category-prev"),onInit:function(e){var i=n.bemagazineDefaultSlideIndex,a=i-1,t=i+1;n.loadPage(e,i),n.loadPage(e,a),n.loadPage(e,t)},onSlideChangeEnd:function(e){var i=e.activeIndex,a=i-1,t=i+1;n.loadPage(e,i),n.loadPage(e,a),n.loadPage(e,t),window.brands.tracker&&window.brands.tracker.trackCarousel(e)}});t.slideTo(e.bemagazineDefaultSlideIndex,0,!1)})})},e.prototype.loadPage=function(e,n){var i=this;if(n>-1&&n<e.slides.length&&e.slides[n]&&(!this.loadOnce||this.loadOnce&&""==$(e.slides[n]).find(this.bemagazineContent).html())){var a=$(e.slides[n]).attr("data-url");this.render(a||"/be-magazine-landing-category.html",$(e.slides[n]).find(this.bemagazineContent)).then(function(a){$(e.slides[n]).find(i.bemagazineContent).html(a),i.postRender(e.slides[n])})}},e.prototype.postRender=function(e){$(e).find(this.articleSlider).each(function(e,n){new Swiper($(n),{loop:!1,slidesPerView:1,paginationClickable:!0,centeredSlides:!1,spaceBetween:0,nested:!0,nextButton:$(n).parent().find(".swiper-next"),prevButton:$(n).parent().find(".swiper-prev")})})},e.prototype.render=function(e,n){var i=this;this.loader.show(n);var a=$.Deferred();return $.get(e).success(function(e){i.loader.hide(n),a.resolve($(e).find(i.bemagazineContentWrapper).html())}).error(function(e){i.loader.hide(n),a.reject(e)}),a.promise()},e}();exports.BeMagazineLanding=BeMagazineLanding,new BeMagazineLanding;