"use strict";var $=require("jquery"),_=require("underscore"),shared_1=require("./shared"),Swiper=require("swiper"),VideoPlayer=function(){function e(){this.loader=new shared_1.Loader,this.className=".campaign-video-player-wrapper",this.template='<iframe src="//about:blank" frameborder="0" allowfullscreen width="100%" height="100%"></iframe>',this.patterns={youtube:{index:"youtube",id:"v=",src:"//www.youtube.com/embed/%id%?autoplay=1"},vimeo:{index:"vimeo",id:"/",src:"//player.vimeo.com/video/%id%?autoplay=1"}},this.loaderWrapper=".campaign-video-loader",this.swiperClass=".js-campaign-video",this.swiperPaginationClass=".swiper-pagination",this.swiperPrevClass=".swiper-prev",this.swiperNextClass=".swiper-next",this.initPlayer()}return e.prototype.initPlayer=function(){var e=this;$(document).ready(function(){$(e.className).each(function(i,r){$(r).on("click",function(){e.play(r)});var a=Math.max.apply(null,$(r).find(".background-container").map(function(e,i){return $(i).height()}).get());$(r).find(".background-container .play-icon").css("top",(a-$(r).find(".background-container .play-icon").height())/2)}),$(e.swiperClass).each(function(i,r){$(r).find(".swiper-slide").length>1?new Swiper(r,{loop:!1,pagination:e.swiperClass+" .swiper-pagination",nextButton:e.swiperClass+" .swiper-next",prevButton:e.swiperClass+" .swiper-prev",slidesPerView:1,paginationClickable:!0,spaceBetween:0,onSlideChangeEnd:function(e){window.brands.tracker&&window.brands.tracker.trackCarousel(e)}}):($(r).find(e.swiperPaginationClass).hide(),$(r).find(e.swiperPrevClass).hide(),$(r).find(e.swiperNextClass).hide())})})},e.prototype.play=function(e){var i=this;this.loader.show($(e).parent().find(this.loaderWrapper),!0);var r=$(e).attr("data-options");if(r){r=JSON.parse(r),window.brands.tracker&&r.vid&&window.brands.tracker.trackVideoPlay(r.vid+"|"+r.name);var a=_.find(this.patterns,function(e){return e.index==r.type});if(a&&r.vid){var t="";t="string"==typeof r.vid?r.vid:r.vid.call(this,t),t=a.src.replace("%id%",t);var n=_.clone(this.template);n=$(n).attr("src",t),r.width&&(n=$(n).attr("width",r.width)),r.height&&(n=$(n).attr("height",r.height)),$(e).html(n[0].outerHTML),$(e).find("iframe").on("load",function(){i.loader.hide($(e).parent().find(i.loaderWrapper))})}}},e}();exports.VideoPlayer=VideoPlayer,new VideoPlayer;