"use strict";var $=require("jquery"),shared_1=require("./shared"),productTemplate=require("product-container-partial"),Swiper=require("swiper"),BeMagazineListing=function(){function e(){this.wrapperClassName=".js-product-container-wrapper",this.swiperSlideClassName=".js-toolbar-container",this.maxAllowedSelection=3,this.ourProductEndPoint="/dummy-data/data.json",this.loader=new shared_1.Loader,this.clearAll="#clearall",this.categorySlider=".js-category-container",this.contenttypeSlider=".js-contenttype-container",this.articleSlider=".js-article-slider",this.rowLoadLimitSelector="data-row-load-limit",this.colLoadLimitSelector="data-col-load-limit",this.rowLoadLimit=1,this.colLoadLimit=4,this.init()}return e.prototype.init=function(){var e=this,i=this;this.render().then(function(i){$(e.wrapperClassName).html(i),e.postRender()}),$(document).ready(function(){e.rowLoadLimit=$(".be-magazine-listing--listing-content").attr(e.rowLoadLimitSelector)||e.rowLoadLimit,e.colLoadLimit=$(".be-magazine-listing--listing-content").attr(e.colLoadLimitSelector)||e.colLoadLimit,$(".js-toolbar-container li").each(function(e,t){$(this).on("click",function(e){if($(t).hasClass("active")===!1){if($(".js-toolbar-container li.active").length>=i.maxAllowedSelection)return;$(t).addClass("active")}else $(t).removeClass("active");i.render().then(function(e){$(i.wrapperClassName).html(e),i.postRender()})})}),$(e.clearAll).on("click",function(){location.reload()}),new Swiper(e.categorySlider,{loop:!1,slidesPerView:6,paginationClickable:!0,centeredSlides:!1,spaceBetween:10,nextButton:".swiper-category-next",prevButton:".swiper-category-prev",breakpoints:{867:{slidesPerView:3},767:{slidesPerView:2}},onInit:function(i){$(e.categorySlider).css("opacity",1)},onSlideChangeEnd:function(e){window.brands.tracker&&window.brands.tracker.trackCarousel(e)}}),new Swiper(e.contenttypeSlider,{loop:!1,slidesPerView:4,paginationClickable:!0,centeredSlides:!1,spaceBetween:10,nextButton:".swiper-category-next1",prevButton:".swiper-category-prev1",breakpoints:{1300:{slidesPerView:3},967:{slidesPerView:2},767:{slidesPerView:1}},onInit:function(i){$(e.contenttypeSlider).css("opacity",1)},onSlideChangeEnd:function(e){window.brands.tracker&&window.brands.tracker.trackCarousel(e)}}),$(e.articleSlider).each(function(e,i){new Swiper($(i),{loop:!1,slidesPerView:1,paginationClickable:!0,centeredSlides:!1,spaceBetween:0,nextButton:$(i).parent().find(".swiper-next"),prevButton:$(i).parent().find(".swiper-prev"),onSlideChangeEnd:function(e){window.brands.tracker&&window.brands.tracker.trackCarousel(e)}})}),e.postRender()})},e.prototype.postRender=function(){var e=this;$(".be-magazine-listing--listing-content").find(".col-xs-12").each(function(i,t){i>=e.rowLoadLimit*e.colLoadLimit&&$(t).hide()}),$(".be-magazine-listing--listing-content .view-all").off().on("click",function(i){$(".be-magazine-listing--listing-content").find(".col-xs-12:hidden").each(function(t,n){t<e.rowLoadLimit*e.colLoadLimit&&$(n).fadeIn(),$(".be-magazine-listing--listing-content").find(".col-xs-12:hidden").length<1&&$(i.currentTarget).hide()})}),$(".be-magazine-listing--listing-content").find(".col-xs-12:hidden").length<1&&$(".be-magazine-listing--listing-content .view-all").hide()},e.prototype.render=function(){var e=this;this.loader.show(this.wrapperClassName);var i="",t=$.Deferred();return $.get(this.ourProductEndPoint).success(function(n){$(".js-toolbar-container li.active").length>0&&n.ourProducts.splice($(".js-toolbar-container li.active").length,n.ourProducts.length);for(var r=0,o=n.ourProducts;r<o.length;r++){var a=o[r];i+=productTemplate.template({title:a.title,tileList:a.tiles})}e.loader.hide(e.wrapperClassName),t.resolve(i)}).error(function(i){e.loader.hide(e.wrapperClassName),t.reject(i)}),t.promise()},e}();exports.BeMagazineListing=BeMagazineListing,new BeMagazineListing;