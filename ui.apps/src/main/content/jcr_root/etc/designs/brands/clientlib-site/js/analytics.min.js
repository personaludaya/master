"use strict";var $=require("jquery");require("jquery.visible");var amplify=require("amplify"),Analytics=function(){function t(){var t=this;this.dataAnalyticsAttr="data-analytics",$(document).ready(function(){t.initDTM();var e={page:{attributes:{siteType:$(window).width()<=window.brands.mobile_screen?"mobile":"desktop"}}};t.extendDataLayer(e),t.initDataExtenders(),t.initDataAnalytics(!1),t.initExternalAndDownloadLinks(),t.initMailTo(),t.initTel(),t.trackOnceForAnalyticsHash()})}return t.prototype.track=function(t){$.extend(!0,brandsDataLayer,t),_satellite.track(t.event.eventInfo.eventType)},t.prototype.checkIfAnalyticsExists=function(){return"undefined"!=typeof _satellite},t.prototype.dtmTrack=function(t,e){var a=this;t&&this.checkIfAnalyticsExists()&&t.event&&t.event.eventInfo&&(e?$(e).on("click",function(t){if($(t.currentTarget).attr(a.dataAnalyticsAttr)){var e=JSON.parse($(t.currentTarget).attr(a.dataAnalyticsAttr)),n=$(t.currentTarget).attr("href");return"a"==t.currentTarget.localName&&n&&"undefined"!=typeof n&&"_blank"!=$(t.currentTarget).attr("target")&&0!=n.indexOf("tel")&&0!=n.indexOf("mailto")?(t.preventDefault(),void a.buildAnalyticsWithLocalStorage(n,e)):void a.track(e)}}):this.track(t))},t.prototype.initDTM=function(){var t=this;$.fn.dtmTrack=function(e,a){t.dtmTrack(e,a)}},t.prototype.extendDataLayer=function(t){$.extend(!0,brandsDataLayer,t)},t.prototype.initDataAnalytics=function(t){var e=this,a=$("*[data-analytics]");t&&(a=$(t).find("*[data-analytics]")),$(a).each(function(t,a){try{var n=JSON.parse($(a).attr(e.dataAnalyticsAttr));$(a).dtmTrack(n,a)}catch(t){}})},t.prototype.initDataExtenders=function(){var t=this;$("*[data-analytics-extend]").each(function(e,a){try{var n=JSON.parse($(a).attr("data-analytics-extend"));t.extendDataLayer(n)}catch(t){}})},t.prototype.initExternalAndDownloadLinks=function(){var t=this;$('a[target="_blank"]:not([data-analytics])').each(function(e,a){$(a).parent().length>0&&$(t).parent().hasClass("swiper-slide")||$(a).on("click",function(t){t.preventDefault();var e=$(t.currentTarget).text(),a="downloadLinks",n=$(t.currentTarget).attr("href"),r=n.indexOf("?");r==-1?r=n.length:r-=1;var i=n.substring(0,r).split(/[\\/]/).pop();i=i.split("."),2!=i.length&&(a="External Link");var o=i.pop().replace(/s+/,"");"html"!=o&&"htm"!=o||(a="External Link"),$(t.currentTarget).attr("href").indexOf("tripadvisor.com")!==-1&&(e="Trip Advisor"),e&&(e=e.replace(/(\r\n|\n|\r)/g,"").replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""));var c={event:{eventInfo:{eventType:a,eventName:e,eventURL:$(t.currentTarget).attr("href")}}};$(t.currentTarget).dtmTrack(c),window.open($(t.currentTarget).attr("href"),"_blank")})})},t.prototype.initMailTo=function(){$('a[href^="mailto:"]:not([data-analytics])').on("click",function(t){var e={event:{eventInfo:{eventType:"sendAnEmail",eventName:$(t.currentTarget).text()}}};$(t.currentTarget).dtmTrack(e)})},t.prototype.initTel=function(){$('a[href^="tel:"]:not([data-analytics])').on("click",function(t){var e={event:{eventInfo:{eventType:"contactUs",eventAction:"call",eventName:"footer:"+$(t.currentTarget).attr("href").replace("tel:","")}}};$(t.currentTarget).dtmTrack(e)})},t.prototype.customTrack=function(t){"string"==typeof t&&(t=JSON.parse(t)),$(this).dtmTrack(t)},t.prototype.buildAnalyticsWithLocalStorage=function(t,e){t&&(e&&("string"==typeof e&&(e=JSON.parse(e)),amplify.store(this.dataAnalyticsAttr,e)),location.href=t)},t.prototype.trackOnceForAnalyticsHash=function(){var t=amplify.store(this.dataAnalyticsAttr);t&&("string"==typeof t&&(t=JSON.parse(t)),$(window).dtmTrack(t),amplify.store(this.dataAnalyticsAttr,null))},t.prototype.trackLifestagesFilter=function(t){var e={event:{eventInfo:{eventType:"product_lifestagefilter",eventName:t}},product:{attributes:{stage:t}}};this.dtmTrack(e,!1)},t.prototype.trackVideoPlay=function(t){var e={event:{eventInfo:{eventType:"video",eventName:t,eventAction:"play"}}};this.dtmTrack(e,!1)},t.prototype.trackSocialShare=function(t,e){var a={event:{eventInfo:{eventType:"social_share",eventName:t,eventURL:e}}};this.dtmTrack(a,!1)},t.prototype.trackFAQCategory=function(t,e){void 0===e&&(e="NIL");var a={event:{eventInfo:{eventType:"faq_click",eventName:t+"|"+e}}};this.dtmTrack(a,!1)},t.prototype.trackChatbotResult=function(t,e,a){var n={event:{eventInfo:{eventType:"chatbot_search"}},search:{searchInfo:{term:t,results:""+e},category:{primaryCategory:"Chat Bot",subCategory:a?a.join(","):""}}};this.dtmTrack(n,!1)},t.prototype.trackCarousel=function(t){if(t){var e=$(t.wrapper).attr("data-name"),a=$(t.slides[t.activeIndex]).attr("data-title"),n=t.activeIndex+1,r=(t.isHorizontal()?"horizontal slide":"vertical slide",{event:{eventInfo:{eventType:t.isHorizontal()?"carousel_horizontal":"carousel_vertical",eventName:e+"|"+n+"|"+a}}});this.dtmTrack(r,!1)}},t}(),analytics=new Analytics;window.brands.tracker=analytics;